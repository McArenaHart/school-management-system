{% extends "base.html" %}
{% block title %}Students Â· SMS{% endblock %}

{% block content %}

  <div class="d-flex align-items-start justify-content-between flex-wrap gap-3 mb-4">
    <div>
      <h4 class="mb-1">Students</h4>
      <p class="text-muted mb-0">Search and manage students.</p>
    </div>
    <a class="btn-cozy" href="{% url 'people:student_create' %}">Add student</a>
  </div>

  <div class="dashboard-panel mb-4">
    <form class="form-grid" method="get">
      <div class="form-group">
        <label class="form-label">Search</label>
        <input class="form-control" name="q" value="{{ q }}" placeholder="Name, grade, class, student number...">
      </div>
      <div class="form-group" style="align-self: end;">
        <button class="btn-cozy w-100" type="submit">Search</button>
      </div>
    </form>
  </div>

  <div class="dashboard-panel">
    <div class="panel-header">
      <span>Student directory</span>
      <span class="pill">Records</span>
    </div>
    <div class="table-responsive">
      <table class="table-cozy align-middle mb-0">
        <thead>
          <tr>
            <th class="ps-3">Student</th>
            <th>Student No.</th>
            <th>Grade</th>
            <th>Class</th>
            <th class="text-end pe-3">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for s in students %}
            <tr>
              <td class="ps-3 fw-semibold">
                {{ s.first_name }} {{ s.last_name }}
                <div class="text-muted small">ID: {{ s.student_id|default:s.student_number|default:"-" }}</div>
              </td>
              <td class="text-muted">{{ s.student_id|default:s.student_number|default:"-" }}</td>
              <td class="text-muted">{{ s.grade|default:"N/A" }}</td>
              <td class="text-muted">{{ s.classroom.name|default:"N/A" }}</td>
              <td class="text-end pe-3">
                <a class="btn btn-sm btn-outline-primary" href="{% url 'people:student_detail' s.id %}">View</a>
                <a class="btn btn-sm btn-outline-secondary" href="{% url 'people:student_edit' s.id %}">Edit</a>
                {% if can_delete_student %}
                  <form class="d-inline-block ms-1" method="post" action="{% url 'people:student_delete' s.id %}">
                    {% csrf_token %}
                    <button class="btn btn-sm btn-outline-danger" type="submit">Delete</button>
                  </form>
                {% endif %}
              </td>
            </tr>
          {% empty %}
            <tr>
              <td colspan="5" class="text-center text-muted py-4">No students found.</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

{% endblock %}
